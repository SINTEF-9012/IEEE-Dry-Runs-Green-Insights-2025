# Mainframe Experiments

This directory contains data and analysis from comprehensive experiments conducted on the GIoT group's mainframe computer with dual measurement approaches.

## Overview

These experiments represent the complete experimental setup using both software-based and hardware-based monitoring to measure the environmental impact of containerized big data pipelines.

## Experimental Setup

- **Environment**: Mainframe computer (GIoT group)
- **Measurement approaches**:
  1. **CarbonTracker**: Software-based energy and CO2 monitoring
  2. **Tapo P115 Smart Plug**: Hardware-based power and energy measurement
- **Configurations tested**: conf-1 through conf-6 (corresponds to; base1, base2, optimized, optimized2, conf-5, conf-6)

## Dual Measurement Approach

### CarbonTracker (Software-based)
- Integrated into the pipeline execution
- Measures energy consumption and estimates CO2 emissions
- Provides detailed per-step measurements
- Data stored in `data/carbontracker/`

### Tapo P115 Smart Plug (Hardware-based)
- Physical power measurement at the electrical socket
- Records power data every 5 minutes
- Retains data for approximately 2 days
- Data exported from Tapo app as XLS files
- Data stored in `data/tapo/`

## Directory Structure

### `analysis/`
Python analysis code and Jupyter notebooks:
- `analysis_functions.py` - Shared analysis functions
- `tapo-analysis-conf-X.ipynb` - Per-configuration Tapo data analysis (manual baseline identification)
- `comparison_analysis.ipynb` - Time synchronization analysis between measurement systems
- `complete-analysis.ipynb` - Final results computation and aggregation

### `data/`
Raw measurement data:
- `carbontracker/` - CarbonTracker measurements for each configuration
  - `conf-1/`, `conf-2/`, ..., `conf-6/` - Per-configuration data
- `tapo/` - Tapo smart plug exported data (XLS files)
- `metadata/` - Metadata including time synchronization data

### `results/`
Processed results and visualizations:
- Final aggregated results (generated by notebooks)
- Generated plots and visualizations

## Key Technical Challenges

### Time Synchronization Issue
A significant time offset (~134 minutes) was discovered between CarbonTracker measurements and Tapo smart plug measurements. This required:
- Manual identification of power surge timing
- Calculation of time differences between measurement systems
- Documentation in `surge_time_diffs.dat` metadata file

### Analysis Methodology
Due to the time synchronization challenge:
1. Manual baseline identification in Tapo data (5-minute resolution)
2. Power surge detection to correlate with pipeline execution
3. Time difference calculation between measurement systems
4. Final results computed by aligning measurements

## Pipeline Configurations

Six configurations were tested:
- **conf-1**: base1 pipeline
- **conf-2**: base2 pipeline  
- **conf-3**: optimized pipeline
- **conf-4**: (Additional configuration)
- **conf-5**: (Additional configuration)
- **conf-6**: (Additional configuration)

## Reproducing the Analysis

### Prerequisites
This analysis uses Python with dependencies managed by `uv`. See `pyproject.toml` for package requirements.

### Setup Environment
```bash
cd data/mainframe
uv sync
```

### Run Analysis
The analysis follows this sequence:

1. **Per-configuration Tapo analysis** (manual baseline identification):
   ```bash
   jupyter notebook tapo-analysis-conf-1.ipynb
   # Repeat for conf-2 through conf-6
   ```

2. **Time synchronization analysis**:
   ```bash
   jupyter notebook comparison_analysis.ipynb
   ```
   This generates `surge_time_diffs.dat` with time offsets.

3. **Complete final analysis**:
   ```bash
   jupyter notebook complete-analysis.ipynb
   ```
   Produces final results files.

## Data Format Notes

### CarbonTracker Output
- Format: Data files per configuration run
- Contains: Energy consumption, CO2 emissions, duration per pipeline step

### Tapo Smart Plug Data
- Format: XLS (Excel) files
- Resolution: Power measurements every 5 minutes
- Retention: ~2 days of historical data
- Note: Data exported after each experimental run

## Results Interpretation

The dual measurement approach allows validation of software-based measurements against hardware readings, providing:
- Cross-validation of energy consumption estimates
- Real-world power consumption patterns
- Assessment of measurement accuracy and reliability

## Notes

- Virtual environment (`.venv`) is not included in repository
- Notebooks may contain embedded output from analysis
- File paths in notebooks may need adjustment depending on execution environment
- Manual steps were required for baseline identification due to 5-minute measurement resolution
